<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="description" content="Digital Concierge Reichshof Hamburg - accessible room search and navigation">
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Reichshof Concierge">
    <meta name="description" content="Digital Concierge Reichshof ‚Äì accessible and intuitive. No guest should get lost.">
    
    <link rel="manifest" href="manifest.json">
    
    <title>Digital Concierge & Accessibility ‚Äì Reichshof Hamburg</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <link rel="stylesheet" href="css/style.css?v=3.0.4">
    
    <!-- REICHSHOF VOICE ASSISTANT STYLES -->
    <style>
        /* ============================================
           REICHSHOF VOICE ASSISTANT STYLES
           ============================================ */
        
        #mic-indicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            z-index: 99999;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            padding: 50px 70px;
            border-radius: 24px;
            box-shadow: 0 25px 80px rgba(0,0,0,0.6), 0 0 0 1px rgba(251, 191, 36, 0.3);
            border: 2px solid rgba(251, 191, 36, 0.4);
            backdrop-filter: blur(20px);
        }
        
        #mic-indicator.active {
            display: flex;
            animation: micFadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes micFadeIn {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }
        
        /* WAVEFORM CONTAINER */
        .visualizer-container {
            width: 320px;
            height: 120px;
            position: relative;
            margin-bottom: 15px;
            background: radial-gradient(ellipse at center, rgba(251, 191, 36, 0.08) 0%, transparent 70%);
            border-radius: 16px;
            overflow: hidden;
        }
        
        #audio-visualizer {
            width: 100%;
            height: 100%;
            border-radius: 16px;
        }
        
        /* MIC PULSE - Reichshof Gold Style */
        .mic-pulse {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #fbbf24, #d97706);
            border-radius: 50%;
            position: relative;
            animation: micPulse 2s ease-in-out infinite;
            box-shadow: 0 10px 40px rgba(251, 191, 36, 0.5);
        }
        
        @keyframes micPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 10px 40px rgba(251, 191, 36, 0.5); }
            50% { transform: scale(1.08); box-shadow: 0 15px 50px rgba(251, 191, 36, 0.7); }
        }
        
        .mic-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 44px;
            color: #0f172a;
        }
        
        /* SOUND WAVES */
        .mic-pulse::before,
        .mic-pulse::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 3px solid #fbbf24;
            border-radius: 50%;
            opacity: 0;
        }
        
        .mic-pulse::before {
            width: 160px;
            height: 160px;
            animation: soundWave 2.5s ease-out infinite;
        }
        
        .mic-pulse::after {
            width: 220px;
            height: 220px;
            animation: soundWave 2.5s ease-out 0.8s infinite;
        }
        
        @keyframes soundWave {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0.6; }
            100% { transform: translate(-50%, -50%) scale(1.8); opacity: 0; }
        }
        
        /* TEXT STYLES */
        .mic-text {
            color: #fbbf24;
            font-size: 22px;
            font-weight: 600;
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-top: 15px;
            text-shadow: 0 2px 10px rgba(251, 191, 36, 0.3);
        }
        
        .interim-text {
            color: #94a3b8;
            font-size: 16px;
            min-height: 24px;
            font-style: italic;
            max-width: 300px;
            text-align: center;
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        
        /* Processing State */
        .mic-processing .mic-pulse {
            animation: none;
            background: linear-gradient(135deg, #22c55e, #16a34a);
        }
        
        .mic-processing .mic-text {
            color: #22c55e;
        }
        
        /* Error State */
        .mic-error .mic-pulse {
            animation: shake 0.5s ease-in-out;
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        .mic-error .mic-text {
            color: #ef4444;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        /* Enhanced Voice Button */
        .voice-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #fbbf24, #d97706);
            border: none;
            cursor: pointer;
            box-shadow: 0 8px 32px rgba(251, 191, 36, 0.4);
            z-index: 10000;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .voice-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 40px rgba(251, 191, 36, 0.6);
        }
        
        .voice-btn:active {
            transform: scale(0.95);
        }
        
        .voice-btn.listening {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            animation: voiceBtnPulse 1.5s ease-in-out infinite;
        }
        
        @keyframes voiceBtnPulse {
            0%, 100% { box-shadow: 0 8px 32px rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 12px 40px rgba(239, 68, 68, 0.7); }
        }
        
        .voice-btn i {
            font-size: 28px;
            color: #0f172a;
        }
        
        /* Voice Response Panel */
        .voice-response {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #0f172a, #1e293b);
            border: 2px solid #fbbf24;
            border-radius: 20px;
            padding: 30px 40px;
            max-width: 500px;
            text-align: center;
            z-index: 99998;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
            display: none;
        }
        
        .voice-response.active {
            display: block;
            animation: responseFadeIn 0.4s ease;
        }
        
        @keyframes responseFadeIn {
            from { opacity: 0; transform: translate(-50%, -45%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }
        
        .voice-response h3 {
            color: #fbbf24;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        .voice-response p {
            color: #e2e8f0;
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        
        .voice-btn-repeat, .voice-btn-close {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .voice-btn-repeat {
            background: #fbbf24;
            color: #0f172a;
        }
        
        .voice-btn-repeat:hover {
            background: #f59e0b;
        }
        
        .voice-btn-close {
            background: rgba(255,255,255,0.1);
            color: #e2e8f0;
        }
        
        .voice-btn-close:hover {
            background: rgba(255,255,255,0.2);
        }
    </style>
</head>
<body>
    <div id="blue-filter" style="position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,100,255,0.1); pointer-events:none; z-index:9998; display:none;"></div>
    <div id="offline-indicator" class="offline-indicator"><i class="fas fa-wifi-slash"></i> <span data-i18n="offline_mode">Offline mode - data loaded from cache</span></div>
    <div id="local-mode-indicator" class="offline-indicator" style="display:none;"><i class="fas fa-file-alt"></i> <span data-i18n="local_mode_notice">Local file mode detected ‚Äì online features are limited.</span></div>
    
    <a href="#main-content" class="skip-link" data-i18n="skip_to_content">Skip to main content</a>
    
    <div class="app-container">
        <header class="header" role="banner">
            <div class="header-top">
                <div class="logo" onclick="showSection('home')">
                    <i class="fas fa-hotel logo-icon"></i>
                    <div>
                        <div class="logo-text" data-i18n="brand_name">Reichshof Hamburg</div>
                        <div class="logo-subtext" data-i18n="brand_sub">Digital Concierge Version drei Punkt null Punkt null</div>
                    </div>
                </div>
                <div class="controls" role="toolbar" aria-label="Sprache und Einstellungen">
                    <span id="backend-status-badge" class="backend-status-badge backend-static" role="status" aria-live="polite">Backend: Static</span>
                    <button class="btn active" data-lang="de" onclick="setLanguage('de')" aria-pressed="true">
                        <span class="sr-only">Deutsch</span> DE
                    </button>
                    <button class="btn" data-lang="en" onclick="setLanguage('en')" aria-pressed="false">
                        <span class="sr-only">English</span> EN
                    </button>
                    <button class="btn" data-lang="es" onclick="setLanguage('es')" aria-pressed="false">
                        <span class="sr-only">Espa√±ol</span> ES
                    </button>
                    <button class="btn" onclick="toggleHighContrast()" aria-label="Toggle high contrast">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn" onclick="increaseFontSize()" aria-label="Increase font size">
                        A plus
                    </button>
                    <button class="btn" id="voice-settings-btn" onclick="openVoiceSettings()" aria-label="Voice settings">
                        <i class="fas fa-cog"></i> <span data-i18n="voice_settings">Voice settings</span>
                    </button>
                    <button class="btn" onclick="window.print()" aria-label="Print page">
                        <i class="fas fa-print"></i>
                    </button>
                </div>
            </div>
            
            <div class="search-container">
                <label for="roomInput" class="sr-only" data-i18n="search_placeholder">Zimmernummer eingeben...</label>
                <input type="text" 
                       id="roomInput" 
                       class="search-input" 
                       data-i18n-placeholder="search_placeholder"
                       placeholder="Zimmernummer eingeben..." 
                       aria-label="Zimmernummer"
                       onkeypress="if(event.key === 'Enter') searchRoomGlobal()">
                <button class="search-btn" onclick="searchRoomGlobal()" aria-label="Zimmer finden">
                    <i class="fas fa-search"></i> <span data-i18n="find_room">ZIMMER FINDEN</span>
                </button>
            </div>
            
            <div class="a11y-toolbar">
                <button class="btn a11y-btn" onclick="speakCurrentSection()" data-i18n-aria="a11y_read" aria-label="Aktuelle Seite vorlesen">
                    <i class="fas fa-volume-up"></i> <span data-i18n="a11y_read">Vorlesen</span>
                </button>
                <button class="btn a11y-btn" onclick="toggleBlueFilter()" data-i18n-aria="a11y_bluefilter" aria-label="Blaufilter ein- oder ausschalten">
                    <i class="fas fa-tint"></i> <span data-i18n="a11y_bluefilter">Blaufilter</span>
                </button>
                <button id="restore-visual-btn" class="btn a11y-btn" onclick="toggleVisualRestore()" aria-pressed="false" data-i18n-aria="visual_restore_title" aria-label="Visuelle Einstellungen beim Start wiederherstellen">
                    <i class="fas fa-power-off"></i> <span id="restore-visual-label">Auto-Restore Off</span>
                </button>
                <button class="btn a11y-btn" onclick="resetAccessibility()" data-i18n-aria="a11y_reset" aria-label="Barrierefreiheitseinstellungen zur√ºcksetzen">
                    <i class="fas fa-undo"></i> <span data-i18n="a11y_reset">Reset</span>
                </button>
            </div>
        </header>
        
        <nav class="main-nav" role="navigation" aria-label="Hauptnavigation">
            <ul class="nav-list" id="nav-list" role="menubar">
                <li role="none"><a href="#" class="nav-link active" onclick="showSection('home')" role="menuitem" aria-current="page"><i class="fas fa-home nav-icon"></i><span class="nav-text" data-i18n="nav_home">Start</span></a></li>
                <li role="none"><a href="#" class="nav-link" onclick="showSection('hotel-info')" role="menuitem"><i class="fas fa-hotel nav-icon"></i><span class="nav-text" data-i18n="nav_hotel_info">Hotelinfo</span></a></li>
                <li role="none"><a href="#" class="nav-link" onclick="showSection('room-search')" role="menuitem"><i class="fas fa-search nav-icon"></i><span class="nav-text" data-i18n="nav_room_search">Zimmersuche</span></a></li>
                <li role="none"><a href="#" class="nav-link" onclick="showSection('floor-plans')" role="menuitem"><i class="fas fa-map nav-icon"></i><span class="nav-text" data-i18n="nav_floor_plans">Grundrisse</span></a></li>
                <li role="none"><a href="#" class="nav-link" onclick="showSection('accessibility')" role="menuitem"><i class="fas fa-wheelchair nav-icon"></i><span class="nav-text" data-i18n="nav_accessibility">Barrierefrei</span></a></li>
                <li role="none"><a href="#" class="nav-link" onclick="showSection('housekeeping')" role="menuitem"><i class="fas fa-concierge-bell nav-icon"></i><span id="nav-housekeeping-label" class="nav-text">Hausservice</span></a></li>
                <li role="none"><a href="#" class="nav-link" onclick="showSection('breakfast-guide')" role="menuitem"><i class="fas fa-egg nav-icon"></i><span id="nav-breakfast-label" class="nav-text">Fr√ºhst√ºck</span></a></li>
                <li role="none"><a href="#" class="nav-link" onclick="showSection('history-poi')" role="menuitem"><i class="fas fa-landmark nav-icon"></i><span id="nav-history-label" class="nav-text">Historie</span></a></li>
                <li role="none"><a href="#" class="nav-link" onclick="showSection('emergency')" role="menuitem"><i class="fas fa-first-aid nav-icon"></i><span class="nav-text" data-i18n="nav_emergency">Notfall</span></a></li>
                <li role="none"><a href="#" class="nav-link" onclick="showSection('qr-codes')" role="menuitem"><i class="fas fa-qrcode nav-icon"></i><span class="nav-text" data-i18n="nav_qr_codes">QR-Codes</span></a></li>
                <li role="none"><a href="#" class="nav-link" onclick="openNewspaperSection()" role="menuitem"><i class="fas fa-newspaper nav-icon"></i><span class="nav-text">Newspapers</span></a></li>
                <li role="none"><a href="#" class="nav-link" onclick="showSection('gallery')" role="menuitem"><i class="fas fa-images nav-icon"></i><span class="nav-text" data-i18n="nav_gallery">Galerie</span></a></li>
                <li role="none"><a href="#" class="nav-link" onclick="showSection('admin-panel')" role="menuitem" style="background: rgba(239, 68, 68, 0.2); border-left: 3px solid #ef4444;"><i class="fas fa-cogs nav-icon"></i><span class="nav-text">üîß Admin - LIFT/TH</span></a></li>
            </ul>
        </nav>
        
        <main id="main-content" class="main-content" role="main">
            <section id="home" class="section active" aria-labelledby="home-title">
                <div class="hero">
                    <h1 id="home-title" class="hero-title" data-i18n="home_welcome">Willkommen im Reichshof Hamburg</h1>
                    <p class="hero-subtitle" data-i18n="home_subtitle">Ihr digitaler Concierge f√ºr barrierefreie Navigation und Information</p>
                </div>
                
                <div class="manifesto glass" style="margin: 2rem 0; padding: 2rem; border-left: 4px solid #00F2FF;">
                    <p class="main-statement" style="font-size: 1.4rem; color: #00F2FF; margin-bottom: 1rem;" data-i18n="manifesto_title">
                        Dieses System ist f√ºr alle da.
                    </p>
                    <ul style="list-style: none; padding: 0; opacity: 0.9;">
                        <li style="margin-bottom: 0.5rem;" data-i18n="manifesto_line_1">F√ºr G√§ste, die ihren Weg schnell finden wollen.</li>
                        <li style="margin-bottom: 0.5rem;" data-i18n="manifesto_line_2">F√ºr Menschen, die nicht fragen m√∂chten.</li>
                        <li style="margin-bottom: 0.5rem;" data-i18n="manifesto_line_3">F√ºr Menschen, die nicht fragen k√∂nnen.</li>
                        <li style="margin-bottom: 0.5rem;" data-i18n="manifesto_line_4">Auch f√ºr Systeme, die Unterst√ºtzung brauchen.</li>
                    </ul>
                    <p style="margin-top: 1.5rem; border-top: 1px solid #333; padding-top: 1rem;">
                        <strong data-i18n="manifesto_line_5">Niemand soll hier verloren gehen.</strong>
                    </p>
                </div>
                
                <div class="quick-cards">
                    <article class="card" onclick="showSection('room-search')" role="button" tabindex="0">
                        <i class="fas fa-search card-icon"></i>
                        <h3 class="card-title" data-i18n="card_find_room_title">Zimmer finden</h3>
                        <p class="card-text" data-i18n="card_find_room_text">Schnelle Suche mit neuer oder alter Zimmernummer. Voice Assistant in drei Sprachen verf√ºgbar.</p>
                    </article>
                    <article class="card" onclick="showSection('hotel-info')" role="button" tabindex="0">
                        <i class="fas fa-hotel card-icon"></i>
                        <h3 class="card-title" data-i18n="card_hotel_info_title">Hotelinformationen</h3>
                        <p class="card-text" data-i18n="card_hotel_info_text">Alle Bereiche des Hotels Bar eintausendeinhundertzehn Restaurant SPA Konferenzr√§ume und mehr.</p>
                    </article>
                    <article class="card" onclick="showSection('accessibility')" role="button" tabindex="0">
                        <i class="fas fa-wheelchair card-icon"></i>
                        <h3 class="card-title" data-i18n="card_accessibility_title">Barrierefreiheit</h3>
                        <p class="card-text" data-i18n="card_accessibility_text">Detaillierte Informationen zu barrierefreien Zimmern zweihundertzw√∂lf zweihundertachtzehn dreihundertachtzehn und Zug√§ngen.</p>
                    </article>
                    <article class="card" onclick="showSection('qr-codes')" role="button" tabindex="0">
                        <i class="fas fa-qrcode card-icon"></i>
                        <h3 class="card-title" data-i18n="card_qr_title">QR-Code System</h3>
                        <p class="card-text" data-i18n="card_qr_text">Microsite QR-Codes f√ºr direkten Zugriff auf wichtige Informationen im Hotel.</p>
                    </article>
                </div>
            </section>
            
            <section id="hotel-info" class="section hidden" aria-labelledby="hotel-info-title">
                <h2 id="hotel-info-title" class="section-title" data-i18n="hotel_areas_title">Hotelbereiche und Informationen</h2>
                
                <div class="hotel-areas">
                    <article class="area-card">
                        <img src="img/Bar-1910-image.jpg" alt="Historische Bar 1910 im Art-D√©co-Stil mit Holztresen und gem√ºtlicher Beleuchtung" class="hotel-area-img" data-i18n-alt="bar1910_alt">
                        <div class="area-content">
                            <h3 data-i18n="bar1910_title">Bar 1910</h3>
                            <p data-i18n="bar1910_description">Original-Art-D√©co-Bar mit Sommerpause vom 28. Juli bis 3. September 2025. Ge√∂ffnet Dienstag bis Samstag 18:00 bis 01:00 Uhr.</p>
                            <div style="display:flex; gap:10px; flex-wrap:wrap;">
                                <button class="btn gold-bg" onclick="openBar1910Menu()">Bar Karte</button>
                                <button class="btn" onclick="openBar1910Page()">Webseite</button>
                            </div>
                        </div>
                    </article>
                    
                    <article class="area-card">
                        <img src="img/Emils-image.jpg" alt="Emil's Bistro mit modernen Sitzgelegenheiten und Tischen in der Hotel-Lobby" class="hotel-area-img" data-i18n-alt="emils_alt">
                        <div class="area-content">
                            <h3 data-i18n="emils_title">Emil's Bistro Caf√© und Bar</h3>
                            <p data-i18n="emils_description">T√§glich von neun Uhr bis null Uhr. Genie√üen Sie hausgemachte Kuchen Kaffee Snacks und Afternoon Tea.</p>
                            <div style="display:flex; gap:10px; flex-wrap:wrap;">
                                <button class="btn gold-bg" onclick="openEmilsFoodMenu()">Food Menu</button>
                                <button class="btn" onclick="openEmilsDrinksMenu()">Drinks Menu</button>
                                <button class="btn" onclick="openAfternoonTeaCard()">Afternoon Tea</button>
                            </div>
                        </div>
                    </article>
                    
                    <article class="area-card">
                        <img src="img/Stadt-Restaurant-image.jpg" alt="Stadt-Restaurant mit eleganten Tischen St√ºhlen und moderner Einrichtung" class="hotel-area-img" data-i18n-alt="restaurant_alt">
                        <div class="area-content">
                            <h3 data-i18n="restaurant_title">Stadt-Restaurant</h3>
                            <p data-i18n="restaurant_description">Tradition trifft Moderne Fr√ºhst√ºck Events und Abendbetrieb. Barrierefreier Zugang durch die Lobby.</p>
                            <div style="display:flex; gap:10px; flex-wrap:wrap;">
                                <button class="btn gold-bg" onclick="openRestaurantMenu()">Men√º Menu</button>
                                <button class="btn" onclick="openRestaurantReservation()">Reservierung</button>
                            </div>
                        </div>
                    </article>
                    
                    <article class="area-card">
                        <img src="img/Spa-Gym-image.jpg" alt="Modernes Fitnessstudio mit Cardioger√§ten und freien Gewichten" class="hotel-area-img" data-i18n-alt="spa_alt">
                        <div class="area-content">
                            <h3 data-i18n="spa_title">SPA und Gym</h3>
                            <p data-i18n="spa_description">Fitnessstudio vierundzwanzig Sieben Stunden ge√∂ffnet. Sauna t√§glich sechzehn Uhr bis zweiundzwanzig Uhr zehn Euro. Zugang √ºber SPA-Fahrstuhl.</p>
                            <div style="display:flex; gap:10px; flex-wrap:wrap;">
                                <button class="btn gold-bg" onclick="openSpaPriceList()">Spa Preisliste</button>
                                <button class="btn" onclick="showSpaContact()">Kontakt</button>
                            </div>
                        </div>
                    </article>
                </div>

                <div style="margin-top: 2rem; display:flex; gap:10px; flex-wrap:wrap; justify-content:center;">
                    <button class="btn" onclick="openGiftVouchers()">Gutscheine</button>
                    <button class="btn" onclick="openClubReichshof()">Club Reichshof</button>
                    <button class="btn" onclick="openOffersPage()">Offers</button>
                </div>

                <div class="ops-grid">
                    <div class="ops-card glass">
                        <h3 id="fo-stay-title"><i class="fas fa-glass-cheers"></i> FO Empfehlung Im Haus genie√üen</h3>
                        <p id="fo-stay-text">F√ºr einen entspannten Abend empfehlen wir unser In-House-Angebot statt externer Wege im HBF-Umfeld.</p>
                        <ul>
                            <li id="fo-stay-item-1">Bar eintausendeinhundertzehn historische Atmosph√§re Signature Drinks Billard.</li>
                            <li id="fo-stay-item-2">Emil's Bar lockere Lounge f√ºr den sp√§ten Abend.</li>
                            <li id="fo-stay-item-3">Stadt-Restaurant regionale K√ºche direkt im Haus.</li>
                        </ul>
                        <p id="fo-stay-note" class="ops-note">Sicherer am Abend kein Gro√üstadttrubel kurze Wege direkt zum Zimmer.</p>
                    </div>

                    <div class="ops-card glass">
                        <h3 id="luggage-title"><i class="fas fa-suitcase"></i> Gep√§cksicherheit Kofferraum</h3>
                        <ul>
                            <li id="luggage-item-1">Gep√§ckraum nur f√ºr autorisiertes Personal video√ºberwacht.</li>
                            <li id="luggage-item-2">Ausgabe nur gegen Original-Ticket oder Koffernummer.</li>
                            <li id="luggage-item-3">Tipp Foto von Koffer plus Ticket direkt beim Abgeben machen.</li>
                        </ul>
                        <p id="luggage-note" class="ops-note">Bei Ticketverlust Ausgabe nur mit Ausweis zur Sicherheit aller G√§ste.</p>
                    </div>

                    <div class="ops-card glass">
                        <h3 id="market-title"><i class="fas fa-store"></i> Vierundzwanzig Stunden Marketplace K√ºhlschrank</h3>
                        <p id="market-location">Standort Lobby gegen√ºber Front Office neben dem Aufgang zu den Konferenzr√§umen.</p>
                        <p id="market-content">Inhalt Getr√§nke Snacks Reise-Utensilien Essentials f√ºr sp√§te Anreisen.</p>
                        <p id="market-note" class="ops-note">Rund um die Uhr verf√ºgbar ideal bei Late Check-in oder Nachtbedarf.</p>
                    </div>
                </div>
            </section>

            <section id="housekeeping" class="section hidden" aria-labelledby="housekeeping-title">
                <h2 id="housekeeping-title" class="section-title gold-text">Housekeeping und Hilfe</h2>
                <div class="feature-shell glass">
                    <p id="housekeeping-intro" class="feature-intro">Service-Anfragen ohne Sprachbarriere Tippen Sie einfach auf den gew√ºnschten Service.</p>
                    <div id="housekeeping-request-grid" class="housekeeping-grid"></div>
                    <div id="housekeeping-status" class="feature-status" aria-live="polite">Bitte w√§hlen Sie einen Service aus.</div>
                    <div class="feature-actions">
                        <button class="btn gold-bg" onclick="sendHousekeepingFeedback()">
                            <i class="fas fa-heart"></i> <span id="housekeeping-feedback-label">Feedback oder Trinkgeld</span>
                        </button>
                    </div>
                </div>
            </section>

            <section id="breakfast-guide" class="section hidden" aria-labelledby="breakfast-guide-title">
                <h2 id="breakfast-guide-title" class="section-title gold-text">Fr√ºhst√ºcks-Ampel und Allergen-Karte</h2>

                <div class="feature-shell glass">
                    <h3 id="breakfast-ampel-title">Fr√ºhst√ºcks-Ampel Uhrzeiten</h3>
                    <div class="ampel-list">
                        <div class="ampel-row ampel-green"><span>üü¢</span><strong>sechs Uhr drei√üig bis acht Uhr</strong><span id="ampel-label-1">Sehr entspannt</span></div>
                        <div class="ampel-row ampel-yellow"><span>üü°</span><strong>acht Uhr bis neun Uhr</strong><span id="ampel-label-2">Moderate Auslastung</span></div>
                        <div class="ampel-row ampel-red"><span>üî¥</span><strong>neun Uhr bis zehn Uhr drei√üig</strong><span id="ampel-label-3">Sto√üzeit Wartezeit m√∂glich</span></div>
                        <div class="ampel-row ampel-green"><span>üü¢</span><strong>zehn Uhr drei√üig bis elf Uhr drei√üig</strong><span id="ampel-label-4">Gem√ºtlicher Ausklang</span></div>
                    </div>
                </div>

                <div class="feature-shell glass" style="margin-top:1.25rem;">
                    <h3 id="allergen-title">Allergen-Karte visuell plus Filter</h3>
                    <div id="allergen-filter-bar" class="allergen-filter-bar"></div>
                    <div id="allergen-dish-grid" class="allergen-dish-grid"></div>
                    <p id="allergen-note" class="ops-note" style="margin-top:0.8rem;">Hinweis Bei starker Unvertr√§glichkeit bitte zus√§tzlich unser F und B-Team ansprechen.</p>
                </div>
            </section>

            <section id="history-poi" class="section hidden" aria-labelledby="history-poi-title">
                <h2 id="history-poi-title" class="section-title gold-text" onclick="speakHistoryRoute()" style="cursor:pointer;" title="Tap f√ºr gesprochene Navigation">Historie POI und Erlebnisorte</h2>

                <div class="ops-grid">
                    <div class="ops-card glass">
                        <h3 id="history-langer-title"><img class="history-coin" src="img/Anton-Emil-Langer.png" alt="Anton Emil Langer"> Gr√ºnder-Gedenktafel</h3>
                        <p id="history-langer-desc">POI Anton Emil Langer Gedenktafel im Zwischengeschoss oberer Treppenabsatz.</p>
                        <p id="history-langer-note">Ein ruhiger Moment f√ºr die Geschichte des Hauses seit neunzehnhundertzehn.</p>
                        <button id="history-langer-btn" class="btn" onclick="openHistoryPoiOnMap('langer_memorial')">Auf Etagenplan anzeigen</button>
                        <div id="book-cross-sell" style="display:none; margin-top:1rem; padding:0.8rem; background:rgba(184,134,11,0.15); border-left:3px solid #b8860b; border-radius:4px;">
                            <p id="book-cross-sell-text" style="margin:0; font-size:0.85rem; color:#e0e0e0;"><i class="fas fa-book" style="margin-right:0.4rem; color:#b8860b;"></i>M√∂chten Sie ein St√ºck Reichshof mit nach Hause nehmen Das exklusive Jubil√§umsbuch zur Geschichte der Familie Langer erhalten Sie direkt bei unseren Kollegen am Front Office oder im Marketplace in der Lobby.</p>
                        </div>
                    </div>

                    <div class="ops-card glass">
                        <h3 id="history-book-title"><i class="fas fa-book"></i> Reichshof Buch</h3>
                        <p id="history-book-desc">Standort Front Office und Marketplace-Regal.</p>
                        <p id="history-book-note">Exklusives Buch zur Geschichte des Reichshofs zum Lesen oder als Souvenir.</p>
                        <button id="history-book-btn" class="btn" onclick="openHistoryPoiOnMap('reichshof_book')">Weg zum Marketplace</button>
                    </div>

                    <div class="ops-card glass">
                        <h3 id="history-autosilo-title"><i class="fas fa-car"></i> Historisches Autosilo</h3>
                        <p id="history-autosilo-desc">Besichtigung als gef√ºhrte Story-Station √ºber Sales- oder Event-Kollegen m√∂glich.</p>
                        <p id="history-autosilo-note" class="ops-note">Bitte F√ºhrung am Front Office oder bei Sales anfragen.</p>
                    </div>
                </div>

                <div class="feature-shell glass" style="margin-top:1.2rem;">
                    <h3 id="history-team-title"><i class="fas fa-users"></i> Unser Concierge-Team</h3>
                    <p id="history-team-text" class="ops-note">Liebe G√§ste f√ºr alle Insiderfragen oder Expertenwissen Z√∂gern Sie nicht unseren menschlichen Concierge um Rat zu bitten. Sie finden ihn am Front Office meist ganz rechts am Tresen Beschilderung vorhanden. Wir sind ein Reichshof-Team mit Respekt und Teamplay heute wie in hundert Jahren.</p>
                    <div style="margin-top:0.8rem;">
                        <button id="history-team-btn" class="btn" onclick="openFrontOfficeCall()"><i class="fas fa-concierge-bell"></i> Front Office anrufen</button>
                    </div>
                </div>
            </section>
            
            <section id="room-search" class="section hidden" aria-labelledby="room-search-title">
                <h2 id="room-search-title" class="section-title" data-i18n="nav_room_search">Zimmersuche und Navigation</h2>
                
                <div class="search-box">
                    <label for="room-input" class="sr-only" data-i18n="search_placeholder">Zimmernummer eingeben...</label>
                    <input type="text" 
                           id="room-input" 
                           class="search-input" 
                           data-i18n-placeholder="search_placeholder"
                           placeholder="Zimmernummer eingeben..."
                           aria-label="Zimmernummer">
                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button class="btn gold-bg" onclick="searchRoom()" style="flex: 1;">
                            <i class="fas fa-location-arrow"></i> <span data-i18n="find_room">ZIMMER FINDEN</span>
                        </button>
                        <button class="btn" onclick="showExampleRooms()" style="flex: 1;">
                            <i class="fas fa-list"></i> <span data-i18n="show_examples">BEISPIELE ANZEIGEN</span>
                        </button>
                    </div>
                </div>
                
                <div id="search-result" class="result-box" role="region" aria-live="polite">
                    <p style="text-align: center; color: #94a3b8;" data-i18n="search_initial_hint">
                        Geben Sie eine Zimmernummer ein um Informationen und Navigationsanleitung zu erhalten.
                    </p>
                </div>
                
                <div style="margin-top: 2rem;">
                    <h3 style="color: var(--accent); margin-bottom: 1rem;" data-i18n="accessible_rooms_title">Barrierefreie Zimmer</h3>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="btn" onclick="searchRoomNumber('212')" data-i18n="room_212">Zimmer zweihundertzw√∂lf</button>
                        <button class="btn" onclick="searchRoomNumber('218')" data-i18n="room_218">Zimmer zweihundertachtzehn</button>
                        <button class="btn" onclick="searchRoomNumber('318')" data-i18n="room_318">Zimmer dreihundertachtzehn</button>
                        <button class="btn" onclick="searchRoomNumber('327')" data-i18n="room_327">Zimmer dreihundertsiebenundzwanzig</button>
                        <button class="btn" onclick="searchRoomNumber('411')" data-i18n="room_411">Zimmer vierhundertelf</button>
                    </div>
                </div>
            </section>
            
            <section id="floor-plans" class="section hidden" aria-labelledby="floor-plans-title">
                <h2 id="floor-plans-title" class="section-title" data-i18n="floor_plans_title">Grundrisse und Etagenpl√§ne</h2>
                
                <div class="floor-tabs">
                    <button class="floor-tab" onclick="loadFloor(0)" data-i18n="floor_eg">Erdgeschoss</button>
                    <button class="floor-tab active" onclick="loadFloor(1)" data-i18n="floor_1og">Eins Punkt Obergeschoss</button>
                    <button class="floor-tab" onclick="loadFloor(2)" data-i18n="floor_2og">Zwei Punkt Obergeschoss</button>
                    <button class="floor-tab" onclick="loadFloor(3)" data-i18n="floor_3og">Drei Punkt Obergeschoss</button>
                    <button class="floor-tab" onclick="loadFloor(4)" data-i18n="floor_4og">Vier Punkt Obergeschoss</button>
                    <button class="floor-tab" onclick="loadFloor(5)" data-i18n="floor_5og">F√ºnf Punkt Obergeschoss</button>
                    <button class="floor-tab" onclick="loadFloor(6)" data-i18n="floor_6og">Sechs Punkt Obergeschoss</button>
                </div>
                
                <div class="map-container">
                    <div id="svg-container" class="map-placeholder">
                        <i class="fas fa-map-marked-alt" style="font-size: 4rem; color: var(--accent); margin-bottom: 1rem;"></i>
                        <h3 style="color: var(--accent); margin-bottom: 0.5rem;" data-i18n="floor_plan_placeholder_title">Etagenplan w√§hlen</h3>
                        <p data-i18n="floor_plan_placeholder_text">W√§hlen Sie eine Etage aus um den Grundriss anzuzeigen.</p>
                    </div>
                </div>
                
                <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(251, 191, 36, 0.1); border-radius: var(--border-radius);">
                    <h4 style="color: var(--accent); margin-bottom: 0.5rem;"><i class="fas fa-info-circle"></i> <span data-i18n="floor_plan_hint_title">Hinweis</span></h4>
                    <p data-i18n="floor_plan_hint_text">Klicken Sie auf ein Zimmer im Grundriss um direkt zur Zimmersuche zu springen.</p>
                </div>
            </section>
            
            <section id="accessibility" class="section hidden" aria-labelledby="accessibility-title">
                <h2 id="accessibility-title" class="section-title" data-i18n="accessibility_title">Barrierefreiheit</h2>
                
                <div class="zimmer-grid">
                    <article class="zimmer-karte">
                        <div class="area-content">
                            <h3 style="color: var(--accent);" data-i18n="room_318_full">Zimmer dreihundertachtzehn drei Punkt Obergeschoss</h3>
                            <div style="margin: 1rem 0;">
                                <p><strong data-i18n="door_width">T√ºrbreite</strong> <span data-i18n="door_90cm">neunzig Zentimeter</span></p>
                                <p><strong data-i18n="bath">Bad</strong> <span data-i18n="bath_318">Bodengleiche Dusche Haltegriffe</span></p>
                                <p><strong data-i18n="bed">Bett</strong> <span data-i18n="bed_318">H√∂he f√ºnfundf√ºnfzig Zentimeter elektrisch verstellbar</span></p>
                            </div>
                            <button class="btn gold-bg" onclick="searchRoomNumber('318')" data-i18n="navigate_to_318">
                                Navigation zu Zimmer dreihundertachtzehn
                            </button>
                        </div>
                        <div class="notruf-info">
                            <strong data-i18n="emergency_system">Notrufsystem</strong>
                            <ul>
                                <li data-i18n="emergency_bed_button">Bettknopf geht zur Rezeption</li>
                                <li data-i18n="emergency_bath_cord">Badleine geht zur OTIS-Notrufzentrale</li>
                                <li data-i18n="emergency_flashing_alarm">Blinkender Alarm vor Zimmer</li>
                            </ul>
                        </div>
                    </article>
                    
                    <article class="zimmer-karte">
                        <div class="area-content">
                            <h3 style="color: var(--accent);" data-i18n="room_212_full">Zimmer zweihundertzw√∂lf zwei Punkt Obergeschoss</h3>
                            <div style="margin: 1rem 0;">
                                <p><strong data-i18n="door_width">T√ºrbreite</strong> <span data-i18n="door_90cm">neunzig Zentimeter</span></p>
                                <p><strong data-i18n="bath">Bad</strong> <span data-i18n="bath_212">Unterfahrbares Waschbecken</span></p>
                                <p><strong data-i18n="turning_circle">Bewegungsfl√§che</strong> <span data-i18n="turning_circle_150">einhundertf√ºnfzig Zentimeter Wendekreis</span></p>
                            </div>
                            <button class="btn gold-bg" onclick="searchRoomNumber('212')" data-i18n="navigate_to_212">
                                Navigation zu Zimmer zweihundertzw√∂lf
                            </button>
                        </div>
                        <div class="notruf-info">
                            <strong data-i18n="emergency_system">Notrufsystem</strong>
                            <ul>
                                <li data-i18n="emergency_bed_button">Bettknopf geht zur Rezeption</li>
                                <li data-i18n="emergency_bath_cord">Badleine geht zur OTIS-Notrufzentrale</li>
                            </ul>
                        </div>
                    </article>
                    
                    <article class="zimmer-karte">
                        <div class="area-content">
                            <h3 style="color: var(--accent);" data-i18n="room_218_full">Zimmer zweihundertachtzehn zwei Punkt Obergeschoss</h3>
                            <div style="margin: 1rem 0;">
                                <p><strong data-i18n="door_width">T√ºrbreite</strong> <span data-i18n="door_90cm">neunzig Zentimeter</span></p>
                                <p><strong data-i18n="bath">Bad</strong> <span data-i18n="bath_218">Duschstuhl Haltegriffe</span></p>
                                <p><strong data-i18n="bed">Bett</strong> <span data-i18n="bed_218">H√∂he f√ºnfzig Zentimeter</span></p>
                            </div>
                            <button class="btn gold-bg" onclick="searchRoomNumber('218')" data-i18n="navigate_to_218">
                                Navigation zu Zimmer zweihundertachtzehn
                            </button>
                        </div>
                        <div class="notruf-info">
                            <strong data-i18n="emergency_system">Notrufsystem</strong>
                            <ul>
                                <li data-i18n="emergency_bed_button">Bettknopf geht zur Rezeption</li>
                                <li data-i18n="emergency_bath_cord">Badleine geht zur OTIS-Notrufzentrale</li>
                            </ul>
                        </div>
                    </article>
                </div>
                
                <div style="margin-top: 3rem; padding: 2rem; background: var(--primary-light); border-radius: var(--border-radius);">
                    <h3 style="color: var(--accent); margin-bottom: 1rem;"><i class="fas fa-elevator"></i> <span data-i18n="lift_guide_title">Lift-Guide</span></h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
                        <div>
                            <p><span style="color: #22c55e; font-weight: bold;">üü¢</span> <strong data-i18n="spa_elevator">SPA-Aufzug einhundertzehn Zentimeter</strong><br>
                            <span data-i18n="spa_elevator_desc">Voll barrierefrei zu allen Etagen und SPA.</span></p>
                        </div>
                        <div>
                            <p><span style="color: #ef4444; font-weight: bold;">üî¥</span> <strong data-i18n="th9_elevator">TH neun Historisch siebzig Zentimeter</strong><br>
                            <span data-i18n="th9_elevator_desc">Zu schmal f√ºr Rollst√ºhle. Historischer Aufzug.</span></p>
                        </div>
                        <div>
                            <p><span style="color: var(--accent); font-weight: bold;">‚ÑπÔ∏è</span> <strong data-i18n="elevator_operation">Bedienung</strong><br>
                            <span data-i18n="elevator_operation_desc">Zimmerkarte f√ºr Etagen ab zwei Punkt Obergeschoss erforderlich.</span></p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="emergency" class="section hidden" aria-labelledby="emergency-title">
                <h2 id="emergency-title" class="section-title" style="color: var(--danger);" data-i18n="emergency_title">Notfall und Sicherheit</h2>
                
                <div class="emergency-grid">
                    <div class="emergency-item">
                        <i class="fas fa-bell emergency-icon"></i>
                        <h4 data-i18n="emergency_flashing_title">Blinkender Alarm</h4>
                        <p data-i18n="emergency_flashing_desc">Optisches Signal vor Zimmern zweihundertzw√∂lf zweihundertachtzehn dreihundertachtzehn bei Notfall.</p>
                    </div>
                    
                    <div class="emergency-item">
                        <i class="fas fa-bath emergency-icon"></i>
                        <h4 data-i18n="emergency_pullcord_title">Bad-Zugleine</h4>
                        <p data-i18n="emergency_pullcord_desc">Vierundzwanzig Sieben Notruf. T√ºr wird automatisch f√ºr Rettungskr√§fte entriegelt.</p>
                    </div>
                    
                    <div class="emergency-item">
                        <i class="fas fa-phone-alt emergency-icon"></i>
                        <h4 data-i18n="emergency_numbers_title">Notrufnummern</h4>
                        <p data-i18n="emergency_numbers_desc">Rezeption 156. Haustechnik 770. Notruf 112.</p>
                    </div>
                </div>
                
                <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(239, 68, 68, 0.1); border-radius: var(--border-radius); border: 1px solid var(--danger);">
                    <h4 style="color: var(--danger); margin-bottom: 1rem;"><i class="fas fa-exclamation-triangle"></i> <span data-i18n="emergency_note_title">Wichtiger Hinweis</span></h4>
                    <p><strong data-i18n="fire_department">Feuerwehr</strong> <span data-i18n="fire_department_time">In circa zehn Minuten vor Ort.</span> <span data-i18n="fire_doors">Brandschutzt√ºren schlie√üen automatisch.</span></p>
                    <p><strong data-i18n="smoking_ban">Rauchen verboten</strong> <span data-i18n="smoking_ban_desc">im gesamten Hotel Hohe Strafkosten.</span></p>
                    <p><strong data-i18n="evacuation">Evakuierung</strong> <span data-i18n="evacuation_point">Sammelpunkt vor dem Haupteingang.</span></p>
                </div>

                <div id="sos-panel" style="display:none; margin-top: 1rem; padding: 1rem; background: rgba(239, 68, 68, 0.15); border: 1px solid #ef4444; border-radius: var(--border-radius);">
                    <h4 style="color:#ef4444; margin-bottom:0.5rem;">Notfall aktiv</h4>
                    <p style="margin:0;">Rezeption intern 156 ¬∑ Haustechnik 770 ¬∑ Intern 555 ¬∑ Notruf 112</p>
                </div>

                <div id="emergency-plan-container" style="margin-top: 20px;">
                    <h2 id="safety-title" style="display:none; color: #b30000;">Evakuierungsplan</h2>
                    <iframe id="pdf-viewer" src="" title="Evakuierungsplan" style="width: 100%; height: 600px; border: 2px solid #b30000; display: none; border-radius: 10px;"></iframe>
                </div>
            </section>

            <section id="qr-codes" class="section hidden" aria-labelledby="qr-codes-title">
                <h2 id="qr-codes-title" class="section-title gold-text">QR-Code Navigation</h2>
                
                <div style="display: flex; flex-direction: column; gap: 2rem;">
                    <div class="glass" style="padding: 2rem; border-radius: 20px; border-left: 4px solid #00F2FF;">
                        <p style="color: #00F2FF; font-size: 1.4rem; font-weight: bold; margin-bottom: 1rem;">
                            F√ºr jeden gedacht.
                        </p>
                        <ul style="list-style: none; padding: 0; color: #f8fafc; margin-bottom: 1.5rem;">
                            <li style="margin-bottom: 0.5rem;">‚úì F√ºr G√§ste die ihren Weg schnell finden wollen.</li>
                            <li style="margin-bottom: 0.5rem;">‚úì F√ºr Menschen die nicht fragen m√∂chten.</li>
                            <li style="margin-bottom: 0.5rem;">‚úì F√ºr Menschen die nicht fragen k√∂nnen.</li>
                            <li style="margin-bottom: 0.5rem;">‚úì Auch f√ºr Systeme die Unterst√ºtzung brauchen.</li>
                        </ul>
                        <p style="color: #fbbf24; text-align: center; margin-top: 1rem; font-style: italic;">
                            Hier findet jeder seinen Weg.
                        </p>
                    </div>

                    <div class="glass newspaper-block">
                        <h3 style="color: #fbbf24; margin-bottom: 0.8rem;">Kostenlose Zeitungen und Magazine</h3>
                        <p style="color:#cbd5e1; margin-bottom: 1rem;">F√ºr G√§ste direkter Zugriff zu tagesaktuellen Zeitungen und Magazinen.</p>
                        <button class="btn gold-bg" onclick="toggleNewspaperQR()">
                            <i class="fas fa-newspaper"></i> QR f√ºr Newspaper anzeigen
                        </button>
                        <div id="newspaper-qr-panel" style="display:none; margin-top:1rem; text-align:center;">
                            <div style="background:#fff; display:inline-block; padding:12px; border-radius:12px;">
                                <canvas id="newspaper-qr-canvas"></canvas>
                                <img id="newspaper-qr-fallback" src="img/ai-robot-smiley.gif" onerror="this.onerror=null;this.src='https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=https%3A%2F%2Fwww.sharemagazines.de%2Flesen ';" alt="AI Robot Smiley" style="display:none; width:180px; height:180px;">
                            </div>
                            <p style="margin-top:0.7rem;"><a href="https://www.sharemagazines.de/lesen " target="_blank" rel="noopener" style="color:#00F2FF;">www Punkt sharemagazines Punkt de Schr√§gstrich lesen</a></p>
                        </div>
                    </div>

                    <div class="glass" style="padding: 2rem; border-radius: 20px; text-align: center;">
                        <h3 style="color: #fbbf24; margin-bottom: 1.5rem;">Zimmer-Navigator Generator</h3>
                        <div id="qr-runtime-badge" role="status" aria-live="polite" data-i18n="qr_online_ready" style="margin: 0 0 1rem 0; padding: 0.65rem 0.9rem; border-radius: 10px; border: 1px solid rgba(34,197,94,0.4); background: rgba(34,197,94,0.12); color: #86efac; font-size: 0.9rem;">
                            <i class="fas fa-circle" style="margin-right: 8px;"></i>Online-Modus QR bereit
                        </div>
                        <div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 2rem;">
                            <input type="text" id="roomNumberInput" placeholder="Zimmernummer" style="padding: 10px; border-radius: 10px; border: none; width: 120px; text-align: center;">
                            <button onclick="generateConciergeQR()" class="qr-button" style="min-height: auto; padding: 10px 20px; background: #fbbf24; color: black; font-weight: bold;">
                                Erstellen
                            </button>
                        </div>
                        <div id="qrcode-container" style="background: white; padding: 15px; display: inline-block; border-radius: 15px; visibility: hidden;">
                            <canvas id="qr-canvas"></canvas>
                            <p class="print-only" style="display:none; color: black; margin-top: 5px;">
                                Hotel Reichshof Zimmer <span id="print-room-num"></span> Ihr digitaler Concierge
                            </p>
                        </div>
                        <button id="printButton" onclick="printQRCode()" style="visibility: hidden; background: #22c55e; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-top: 10px;">
                            <i class="fas fa-print"></i> QR-Code drucken
                        </button>
                        <p id="qr-status" style="color: #94a3b8; margin-top: 1rem;">Geben Sie eine Zimmernummer ein um den Navigator zu starten.</p>
                    </div>
                </div>
            </section>

            <section id="gallery" class="section hidden" aria-labelledby="gallery-title">
                <h2 id="gallery-title" class="section-title" data-i18n="gallery_title">Fotogalerie</h2>
                
                <div class="gallery-filter">
                    <button class="btn active" onclick="filterGallery('all')" data-i18n="gallery_all">Alle</button>
                    <button class="btn" onclick="filterGallery('lobby')" data-i18n="gallery_lobby">Lobby</button>
                    <button class="btn" onclick="filterGallery('zimmer')" data-i18n="gallery_rooms">Zimmer</button>
                    <button class="btn" onclick="filterGallery('restaurant')" data-i18n="gallery_restaurant">Restaurant</button>
                    <button class="btn" onclick="filterGallery('spa')" data-i18n="gallery_spa">SPA</button>
                    <button class="btn" onclick="filterGallery('konferenz')" data-i18n="gallery_conference">Konferenz</button>
                </div>
                
                <div class="gallery-grid">
                    <div class="gallery-item" data-category="lobby">
                       <img src="img/Lobby-Panoramafoto.jpeg" alt="Panoramafoto der Lobby mit Rezeption Sitzbereichen und Zugang zum Restaurant" class="hotel-area-img" data-i18n-alt="gallery_lobby_alt">
                    </div>
                    <div class="gallery-item" data-category="restaurant">
                        <img src="img/Stadt-Restaurant-image.jpg" alt="Blick auf das Stadt-Restaurant von der Lobby aus" class="hotel-area-img" data-i18n-alt="gallery_restaurant_alt"> 
                    </div>
                    <div class="gallery-item" data-category="zimmer">
                       <img src="img/zimmer.jpg" alt="Modernes Hotelzimmer mit komfortabler Einrichtung" class="hotel-area-img" data-i18n-alt="gallery_room_alt">
                    </div>
                    <div class="gallery-item" data-category="spa">
                        <img src="img/Spa-Gym-image.jpg" alt="Modernes Fitnessstudio mit verschiedenen Trainingsger√§ten" class="hotel-area-img" data-i18n-alt="gallery_spa_alt">
                    </div>
                    <div class="gallery-item" data-category="konferenz">
                        <img src="img/Hans-Albers.jpg" alt="Moderner Konferenzraum mit Tischen und St√ºhlen" class="hotel-area-img" data-i18n-alt="gallery_conference_alt">
                    </div>
                    <div class="gallery-item" data-category="lobby">
                      <img src="img/Bar-1910-image.jpg" alt="Historische Bar eintausendeinhundertzehn im Art-D√©co-Stil" class="hotel-area-img" data-i18n-alt="gallery_bar1910_alt">
                    </div>
                </div>
            </section>

            <section id="admin-panel" class="section hidden" aria-labelledby="admin-title">
                <h2 id="admin-title" class="section-title" style="color: #ef4444;">üîß Admin Panel - LIFT & TH Marker</h2>
                
                <div class="glass" style="padding: 2rem; margin-bottom: 2rem; border-left: 4px solid #ef4444;">
                    <h3 style="color: #fbbf24; margin-bottom: 1rem;">üìç Referenzpunkte auf Grundrissen markieren</h3>
                    <p style="color: #94a3b8; margin-bottom: 1.5rem;">
                        Markiere die Position von <strong style="color: #22c55e;">LIFT</strong> (Aufzug) und 
                        <strong style="color: #3b82f6;">TH</strong> (Treppenhaus Nord/S√ºd) auf jedem Etagenplan.
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.5rem; margin-top: 2rem;">
                        <!-- EG -->
                        <div class="glass" style="padding: 1.5rem; border: 2px solid rgba(255, 255, 255, 0.1);">
                            <h4 style="color: #00F2FF; margin-bottom: 1rem;"><i class="fas fa-layer-group"></i> Erdgeschoss (EG)</h4>
                            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                <button onclick="markReferencePoint('EG', 'LIFT_MAIN')" class="btn" style="background: #22c55e; padding: 0.75rem;">
                                    <i class="fas fa-elevator"></i> LIFT markieren
                                </button>
                                <button onclick="markReferencePoint('EG', 'TH_NORTH')" class="btn" style="background: #3b82f6; padding: 0.75rem;">
                                    <i class="fas fa-stairs"></i> TH Nord markieren
                                </button>
                                <button onclick="markReferencePoint('EG', 'TH_SOUTH')" class="btn" style="background: #8b5cf6; padding: 0.75rem;">
                                    <i class="fas fa-stairs"></i> TH S√ºd markieren
                                </button>
                            </div>
                        </div>
                        
                        <!-- 1. OG -->
                        <div class="glass" style="padding: 1.5rem; border: 2px solid rgba(255, 255, 255, 0.1);">
                            <h4 style="color: #00F2FF; margin-bottom: 1rem;"><i class="fas fa-layer-group"></i> 1. Obergeschoss</h4>
                            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                <button onclick="markReferencePoint('1OG', 'LIFT_MAIN')" class="btn" style="background: #22c55e; padding: 0.75rem;">
                                    <i class="fas fa-elevator"></i> LIFT markieren
                                </button>
                                <button onclick="markReferencePoint('1OG', 'TH_NORTH')" class="btn" style="background: #3b82f6; padding: 0.75rem;">
                                    <i class="fas fa-stairs"></i> TH Nord markieren
                                </button>
                                <button onclick="markReferencePoint('1OG', 'TH_SOUTH')" class="btn" style="background: #8b5cf6; padding: 0.75rem;">
                                    <i class="fas fa-stairs"></i> TH S√ºd markieren
                                </button>
                            </div>
                        </div>
                        
                        <!-- 2. OG -->
                        <div class="glass" style="padding: 1.5rem; border: 2px solid rgba(255, 255, 255, 0.1);">
                            <h4 style="color: #00F2FF; margin-bottom: 1rem;"><i class="fas fa-layer-group"></i> 2. Obergeschoss</h4>
                            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                <button onclick="markReferencePoint('2OG', 'LIFT_MAIN')" class="btn" style="background: #22c55e; padding: 0.75rem;">
                                    <i class="fas fa-elevator"></i> LIFT markieren
                                </button>
                                <button onclick="markReferencePoint('2OG', 'TH_NORTH')" class="btn" style="background: #3b82f6; padding: 0.75rem;">
                                    <i class="fas fa-stairs"></i> TH Nord markieren
                                </button>
                                <button onclick="markReferencePoint('2OG', 'TH_SOUTH')" class="btn" style="background: #8b5cf6; padding: 0.75rem;">
                                    <i class="fas fa-stairs"></i> TH S√ºd markieren
                                </button>
                            </div>
                        </div>
                        
                        <!-- 3. OG -->
                        <div class="glass" style="padding: 1.5rem; border: 2px solid rgba(255, 255, 255, 0.1);">
                            <h4 style="color: #00F2FF; margin-bottom: 1rem;"><i class="fas fa-layer-group"></i> 3. Obergeschoss</h4>
                            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                <button onclick="markReferencePoint('3OG', 'LIFT_MAIN')" class="btn" style="background: #22c55e; padding: 0.75rem;">
                                    <i class="fas fa-elevator"></i> LIFT markieren
                                </button>
                                <button onclick="markReferencePoint('3OG', 'TH_NORTH')" class="btn" style="background: #3b82f6; padding: 0.75rem;">
                                    <i class="fas fa-stairs"></i> TH Nord markieren
                                </button>
                                <button onclick="markReferencePoint('3OG', 'TH_SOUTH')" class="btn" style="background: #8b5cf6; padding: 0.75rem;">
                                    <i class="fas fa-stairs"></i> TH S√ºd markieren
                                </button>
                            </div>
                        </div>
                        
                        <!-- 4. OG -->
                        <div class="glass" style="padding: 1.5rem; border: 2px solid rgba(255, 255, 255, 0.1);">
                            <h4 style="color: #00F2FF; margin-bottom: 1rem;"><i class="fas fa-layer-group"></i> 4. Obergeschoss</h4>
                            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                <button onclick="markReferencePoint('4OG', 'LIFT_MAIN')" class="btn" style="background: #22c55e; padding: 0.75rem;">
                                    <i class="fas fa-elevator"></i> LIFT markieren
                                </button>
                                <button onclick="markReferencePoint('4OG', 'TH_NORTH')" class="btn" style="background: #3b82f6; padding: 0.75rem;">
                                    <i class="fas fa-stairs"></i> TH Nord markieren
                                </button>
                                <button onclick="markReferencePoint('4OG', 'TH_SOUTH')" class="btn" style="background: #8b5cf6; padding: 0.75rem;">
                                    <i class="fas fa-stairs"></i> TH S√ºd markieren
                                </button>
                            </div>
                        </div>
                        
                        <!-- 5. OG -->
                        <div class="glass" style="padding: 1.5rem; border: 2px solid rgba(255, 255, 255, 0.1);">
                            <h4 style="color: #00F2FF; margin-bottom: 1rem;"><i class="fas fa-layer-group"></i> 5. Obergeschoss</h4>
                            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                <button onclick="markReferencePoint('5OG', 'LIFT_MAIN')" class="btn" style="background: #22c55e; padding: 0.75rem;">
                                    <i class="fas fa-elevator"></i> LIFT markieren
                                </button>
                                <button onclick="markReferencePoint('5OG', 'TH_NORTH')" class="btn" style="background: #3b82f6; padding: 0.75rem;">
                                    <i class="fas fa-stairs"></i> TH Nord markieren
                                </button>
                                <button onclick="markReferencePoint('5OG', 'TH_SOUTH')" class="btn" style="background: #8b5cf6; padding: 0.75rem;">
                                    <i class="fas fa-stairs"></i> TH S√ºd markieren
                                </button>
                            </div>
                        </div>
                        
                        <!-- 6. OG -->
                        <div class="glass" style="padding: 1.5rem; border: 2px solid rgba(255, 255, 255, 0.1);">
                            <h4 style="color: #00F2FF; margin-bottom: 1rem;"><i class="fas fa-layer-group"></i> 6. Obergeschoss</h4>
                            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                <button onclick="markReferencePoint('6OG', 'LIFT_MAIN')" class="btn" style="background: #22c55e; padding: 0.75rem;">
                                    <i class="fas fa-elevator"></i> LIFT markieren
                                </button>
                                <button onclick="markReferencePoint('6OG', 'TH_NORTH')" class="btn" style="background: #3b82f6; padding: 0.75rem;">
                                    <i class="fas fa-stairs"></i> TH Nord markieren
                                </button>
                                <button onclick="markReferencePoint('6OG', 'TH_SOUTH')" class="btn" style="background: #8b5cf6; padding: 0.75rem;">
                                    <i class="fas fa-stairs"></i> TH S√ºd markieren
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem; padding: 1rem; background: rgba(239, 68, 68, 0.1); border-radius: 10px; border: 1px solid rgba(239, 68, 68, 0.3);">
                        <p style="color: #fca5a5; font-size: 0.9rem;">
                            <i class="fas fa-info-circle"></i> <strong>Hinweis:</strong> 
                            Klicke auf einen Button, dann √∂ffnet sich der Grundriss. 
                            Setze die Markierung durch Klicken oder Ziehen auf die richtige Position.
                        </p>
                    </div>
                </div>
            </section>
        </main>

        <footer class="footer" role="contentinfo">
            <div class="footer-links">
                <a href="#" onclick="showSection('accessibility')" data-i18n="footer_accessibility">Barrierefreiheit</a>
                <a href="#" onclick="showSection('emergency')" data-i18n="footer_emergency">Notfall</a>
                <a href="#" onclick="showSection('qr-codes')" data-i18n="footer_qr">QR-Codes</a>
                <a href="tel:+49403702590" data-i18n="footer_reception">üìû Rezeption: +49 40 370 2590</a>
                <a href="tel:112" style="color:#ef4444; font-weight:bold;" aria-label="Notruf 112 anrufen">Notruf 112</a>
            </div>
            
            <div style="margin-top: 1.5rem; font-size: 0.9rem; color: #94a3b8;">
                <p data-i18n="footer_copyright">
                    ¬© 2026 Reichshof Hamburg | Digital Concierge v3.0.0
                </p>

                <p style="margin-top: 0.5rem;">
                    <span id="connection-status" style="color: #22c55e;" data-i18n="online" aria-live="polite" role="status">
                        ‚óè Online ‚Äì System aktiv
                    </span> | 

                    <span id="version">Build Version 3.0.0</span> |

                    <button onclick="requestNotificationPermission()" style="background: none; border: none; color: var(--accent); cursor: pointer; text-decoration: underline;" data-i18n="enable_push">
                        Push-Dienste aktivieren
                    </button>
                </p>

                <div id="tech-dashboard" class="tech-dashboard" aria-live="polite">
                    <h4>System Monitor</h4>
                    <div id="tech-dashboard-content">Lade System√ºberpr√ºfungen...</div>
                    <button onclick="openPinModal('fire-protocol')" style="margin-top:0.75rem; background: #22c55e; color: white; padding: 10px 20px; border-radius: 5px; font-weight: bold; cursor: pointer; border: none;">
                        Protokoll f√ºr die Feuerwehr generieren
                    </button>
                    <div id="firefighter-protocol" class="fire-protocol">
                        <h5>Protokoll f√ºr die Feuerwehr ‚Äì Kurzfassung</h5>
                        <p><strong>Ausgestellt am</strong> <span id="fire-protocol-timestamp">‚Äî</span></p>
                        <p><strong>Adresse</strong> Reichshof Hamburg ¬∑ Kirchenallee 34-36 ¬∑ 20099 Hamburg</p>
                        <p><strong>Interne Notrufnummern</strong> Rezeption 156 ¬∑ Haustechnik 770 ¬∑ Intern 555 ¬∑ Notruf 112</p>
                        <ul>
                            <li><strong>Defibrillator (AED)</strong> Front Office / Backoffice</li>
                            <li><strong>Tragestuhl Treppenrettung</strong> 1. OG ¬∑ Serviceraum TH-7 ¬∑ √úbergang Zimmer 114 bis 118</li>
                            <li><strong>Sammelpunkt</strong> Vor dem Haupteingang</li>
                        </ul>
                        <p><strong>Hinweis</strong> Brandschutzt√ºren schlie√üen automatisch. Zimmerkarten im 1. OG f√ºr Flurbereiche sofort erforderlich (Richtung Zimmer 103 oder 104). Aufzug ins 1. OG ohne Karte m√∂glich. Ab 2. OG durchgehend erforderlich.</p>
                    </div>
                </div>

                <p style="margin-top: 1rem; font-size: 0.8rem;" data-i18n="wcag_statement">
                    WCAG 2.1 AA konform | Barrierefreiheit ab 28.06.2025 verpflichtend
                </p>

                <p style="margin-top: 0.5rem; font-size: 0.8rem; color:#cbd5e1;" data-i18n="system_message">
                    Dieses System ist f√ºr alle da. Niemand soll hier verloren gehen.
                </p>
            </div>
        </footer>
    </div>
    
    <!-- REICHSHOF VOICE ASSISTANT BUTTON -->
    <button class="voice-btn" id="voice-btn" onclick="toggleVoiceAssistant()" aria-label="Sprachsteuerung starten oder stoppen" aria-pressed="false" data-i18n-aria="voice_assistant_label">
        <i class="fas fa-microphone" id="mic-icon"></i>
    </button>
    
    <!-- MIC INDICATOR S WAVEFORM-OM -->
    <div id="mic-indicator">
        <div class="visualizer-container">
            <canvas id="audio-visualizer"></canvas>
        </div>
        <div class="mic-pulse">
            <div class="mic-icon">
                <i class="fas fa-microphone"></i>
            </div>
        </div>
        <div class="mic-text">Ich h√∂re zu...</div>
        <div class="interim-text"></div>
    </div>
    
    <!-- VOICE RESPONSE PANEL -->
    <div id="voice-response" class="voice-response">
        <h3><i class="fas fa-robot" style="color: #fbbf24; margin-right: 10px;"></i>Reichshof Assistant</h3>
        <p id="voice-response-text"></p>
        <button class="voice-btn-repeat" onclick="reichshofAssistant.speakResponse()">
            <i class="fas fa-volume-up"></i> Wiederholen
        </button>
        <button class="voice-btn-close" onclick="reichshofAssistant.hideResponse()">
            <i class="fas fa-times"></i> Schlie√üen
        </button>
    </div>

    <!-- SOS BUTTON -->
    <button id="sosButton" onclick="activateSOS()" style="position: fixed; bottom: 160px; right: 20px; width: 70px; height: 70px; border-radius: 50%; background: #ef4444; color: white; font-weight: bold; border: 4px solid white; box-shadow: 0 4px 20px rgba(239,68,68,0.5); z-index: 10000; cursor: pointer; font-size: 1.2rem;">Notfall</button>
    
    <!-- VOICE SETTINGS MODAL -->
    <div id="voice-settings-modal" role="dialog" aria-modal="true" aria-hidden="true" style="display:none; position:fixed; left:50%; top:50%; transform:translate(-50%,-50%); background:var(--primary-light); color:white; padding:16px; border-radius:12px; z-index:20001; width:360px; box-shadow:0 10px 30px rgba(0,0,0,0.4);">
        <h3 style="margin-top:0;" data-i18n="voice_settings_title">Stimmeinstellungen</h3>
        <p style="font-size:13px; color:#cbd5e1;" data-i18n="voice_settings_desc">W√§hlen Sie bevorzugte Stimmen f√ºr jede Sprache.</p>
        <div style="display:flex; gap:8px; margin-top:8px; flex-direction:column;">
            <label data-i18n="language_de">Deutsch</label>
            <div style="display:flex; gap:8px;"><select id="voice-select-de" style="flex:1;"></select><button class="btn" onclick="previewVoice('de')" data-i18n="voice_preview">Vorschau</button></div>
            <label data-i18n="language_en">English</label>
            <div style="display:flex; gap:8px;"><select id="voice-select-en" style="flex:1;"></select><button class="btn" onclick="previewVoice('en')" data-i18n="voice_preview">Preview</button></div>
            <label data-i18n="language_es">Espa√±ol</label>
            <div style="display:flex; gap:8px;"><select id="voice-select-es" style="flex:1;"></select><button class="btn" onclick="previewVoice('es')" data-i18n="voice_preview">Vista</button></div>
        </div>
        <div style="display:flex; gap:8px; margin-top:12px; justify-content:flex-end;">
            <button class="btn" onclick="closeVoiceSettings()" data-i18n="voice_close">Schliessen</button>
            <button class="btn gold-bg" onclick="saveVoiceSelection()" data-i18n="voice_save">Speichern</button>
        </div>
    </div>

    <!-- PIN MODAL -->
    <div id="pin-modal-overlay" class="pin-overlay" onclick="closePinModal()" style="display:none;"></div>
    <div id="pin-modal" class="pin-modal" role="dialog" aria-modal="true" aria-hidden="true" style="display:none;">
        <h3 style="margin-top:0;">PIN erforderlich</h3>
        <p style="font-size:13px; color:#cbd5e1;">Bitte PIN eingeben um zu drucken.</p>
        <input id="pin-input" type="password" inputmode="numeric" pattern="[0-9]*" maxlength="6" placeholder="PIN" class="pin-input" />
        <div class="pin-actions">
            <button class="btn" onclick="closePinModal()">Abbrechen</button>
            <button class="btn gold-bg" onclick="submitPinModal()">Best√§tigen</button>
        </div>
        <p id="pin-error" class="pin-error" style="display:none;">Falscher PIN.</p>
    </div>
    
    <!-- WCAG TOOLBAR -->
    <div class="wcag-toolbar" role="toolbar" aria-label="Barrierefreiheits Werkzeuge">
        <button class="wcag-btn" onclick="increaseFontSize()" aria-label="Schriftgr√∂√üe erh√∂hen" data-i18n-aria="increase_font">
            A plus
        </button>
        <button class="wcag-btn" onclick="decreaseFontSize()" aria-label="Schriftgr√∂√üe verringern" data-i18n-aria="decrease_font">
            A minus
        </button>
        <button class="wcag-btn" onclick="resetFontSize()" aria-label="Schriftgr√∂√üe zur√ºcksetzen" data-i18n-aria="reset_font">
            A
        </button>
        <button class="wcag-btn" onclick="speakPageTitle()" aria-label="Seitentitel vorlesen" data-i18n-aria="speak_title">
            Lautsprecher
        </button>
    </div>
    
    <!-- ANALYTICS PANEL -->
    <div id="analytics-overlay" class="analytics-overlay" onclick="toggleAnalytics()"></div>
    <div id="analytics-panel" class="analytics-panel glass">
        <h2 class="gold-text"><i class="fas fa-chart-line"></i> <span data-i18n="analytics_title">Nutzung und Analytics</span></h2>
        <div id="analytics-content" style="margin:20px 0;">Lade Nutzungsdaten...</div>
        <button class="btn gold-bg" onclick="toggleAnalytics()" data-i18n="close">Schlie√üen</button>
    </div>

    <!-- PWA BANNER -->
    <div id="pwa-banner" style="display:none; position:fixed; bottom:20px; left:20px; background:white; padding:15px; z-index:10000; border-radius:10px; box-shadow:0 4px 15px rgba(0,0,0,0.3); align-items:center; gap:10px;">
        <p style="color:black; margin:0;">Als App installieren?</p>
        <button onclick="installPwa()" style="background:gold; padding:5px 10px; border:none; border-radius:5px;">Installieren</button>
        <button onclick="dismissPwaBanner()" style="background:lightgrey; padding:5px 10px; border:none; border-radius:5px;">X</button>
    </div>
 
    <!-- NOTIFICATION -->
    <div id="notification" class="notification" role="alert"></div>
    
    <!-- POSTOJEƒÜI SKRIPTOVI -->
    <script src="js/data/pdf-map.js?v=3.0.5"></script>
    <script src="js/voice-navigation.js?v=3.0.4"></script>
    <script src="js/voice-navigation-builder.js?v=3.0.4"></script>
    <script src="js/emergency-navigation.js?v=3.0.4"></script>
    <script src="js/reference-point-manager.js?v=3.0.4"></script>
    <script src="js/script.js?v=3.0.4"></script>
    
    <!-- REICHSHOF VOICE ASSISTANT - INLINE VERZIJA -->
    <script>
        /**
         * REICHSHOF HAMBURG - VOICE ASSISTANT + WAVEFORM VISUALIZER
         * Version: 3.0.5
         * Integracija s postojeƒáim Digital Concierge sustavom
         */

        class ReichshofVoiceAssistant {
            constructor() {
                this.audioAssets = {
                    system: {
                        micStart: 'https://raw.githubusercontent.com/zeljkobratic69-techBajteBrate/audio-uploader/main/0000a7dc.mp3',
                        micStop: 'https://raw.githubusercontent.com/zeljkobratic69-techBajteBrate/audio-uploader/main/0000a7dd.mp3',
                        error: 'https://raw.githubusercontent.com/zeljkobratic69-techBajteBrate/audio-uploader/main/0000a7de.mp3',
                        success: 'https://raw.githubusercontent.com/zeljkobratic69-techBajteBrate/audio-uploader/main/0000b054.mp3'
                    }
                };
                
                this.lang = 'de-DE';
                this.isListening = false;
                this.isProcessing = false;
                this.audioContext = null;
                this.analyser = null;
                this.dataArray = null;
                this.animationId = null;
                this.timeData = null;
                this.phase = 0;
                this.lastResponse = '';
                this.recognition = null;
                
                // Referenca na postojeƒái roomDatabase
                this.roomDatabase = window.roomDatabase || {};
                
                // Inicijalizacija
                this.init();
            }

            init() {
                // Pove≈æi s postojeƒáim elementima
                this.micContainer = document.getElementById('mic-indicator');
                this.canvas = document.getElementById('audio-visualizer');
                this.canvasCtx = this.canvas.getContext('2d');
                
                // Postavi canvas za retina display
                const dpr = window.devicePixelRatio || 1;
                this.canvas.width = 320 * dpr;
                this.canvas.height = 120 * dpr;
                this.canvas.style.width = '320px';
                this.canvas.style.height = '120px';
                this.canvasCtx.scale(dpr, dpr);
                
                // Voice response panel
                this.responsePanel = document.getElementById('voice-response');
                this.responseText = document.getElementById('voice-response-text');
                
                console.log('üéôÔ∏è Reichshof Voice Assistant initialized');
            }

            async toggle() {
                if (this.isListening) {
                    this.stop();
                } else {
                    await this.start();
                }
            }

            stop() {
                this.isListening = false;
                this.hideMicIndicator();
                this.updateButtonState();
                
                if (this.recognition) {
                    try {
                        this.recognition.stop();
                    } catch(e) {}
                }
                
                this.playSystemSound('micStop');
            }

            updateButtonState() {
                const btn = document.getElementById('voice-btn');
                const icon = document.getElementById('mic-icon');
                
                if (!btn) return;
                
                if (this.isListening) {
                    btn.classList.add('listening');
                    btn.setAttribute('aria-pressed', 'true');
                    if (icon) icon.className = 'fas fa-stop';
                } else {
                    btn.classList.remove('listening');
                    btn.setAttribute('aria-pressed', 'false');
                    if (icon) icon.className = 'fas fa-microphone';
                }
            }

            async initAudioContext(stream) {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    this.analyser = this.audioContext.createAnalyser();
                    
                    const source = this.audioContext.createMediaStreamSource(stream);
                    source.connect(this.analyser);
                    
                    this.analyser.fftSize = 2048;
                    this.bufferLength = this.analyser.frequencyBinCount;
                    this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);
                    this.timeData = new Uint8Array(this.analyser.fftSize);
                    
                    this.startWaveform();
                } catch (e) {
                    console.warn('Audio context init failed:', e);
                }
            }

            startWaveform() {
                if (!this.canvasCtx) return;
                
                const ctx = this.canvasCtx;
                const width = 320;
                const height = 120;
                const centerY = height / 2;
                
                const draw = () => {
                    if (!this.isListening) return;
                    
                    this.animationId = requestAnimationFrame(draw);
                    
                    if (this.analyser && this.timeData) {
                        this.analyser.getByteTimeDomainData(this.timeData);
                    }
                    
                    // Fade efekt
                    ctx.fillStyle = 'rgba(15, 23, 42, 0.2)';
                    ctx.fillRect(0, 0, width, height);
                    
                    // Postavi stil
                    ctx.lineWidth = 3;
                    ctx.lineCap = 'round';
                    ctx.lineJoin = 'round';
                    
                    // Zlatni gradijent
                    const gradient = ctx.createLinearGradient(0, 0, width, 0);
                    gradient.addColorStop(0, 'rgba(251, 191, 36, 0.2)');
                    gradient.addColorStop(0.5, '#fbbf24');
                    gradient.addColorStop(1, 'rgba(251, 191, 36, 0.2)');
                    ctx.strokeStyle = gradient;
                    
                    // Glow
                    ctx.shadowColor = '#fbbf24';
                    ctx.shadowBlur = 20;
                    ctx.shadowOffsetX = 0;
                    ctx.shadowOffsetY = 0;
                    
                    // Nacrtaj waveform
                    ctx.beginPath();
                    
                    const dataLength = this.timeData ? this.timeData.length : 100;
                    const sliceWidth = width / dataLength;
                    let x = 0;
                    
                    this.phase += 0.05;
                    
                    for (let i = 0; i < dataLength; i++) {
                        let v = 0;
                        if (this.timeData) {
                            v = (this.timeData[i] - 128) / 128;
                        } else {
                            v = Math.sin(this.phase + i * 0.1) * 0.3;
                        }
                        
                        const liveFactor = 1 + Math.sin(this.phase + i * 0.01) * 0.15;
                        const amplitude = v * height * 0.35 * liveFactor;
                        const y = centerY + amplitude;
                        
                        if (i === 0) {
                            ctx.moveTo(x, y);
                        } else {
                            const prevX = x - sliceWidth;
                            let prevV = 0;
                            if (this.timeData) {
                                prevV = (this.timeData[i-1] - 128) / 128;
                            } else {
                                prevV = Math.sin(this.phase + (i-1) * 0.1) * 0.3;
                            }
                            const prevY = centerY + (prevV * height * 0.35);
                            const cpX = (prevX + x) / 2;
                            const cpY = (prevY + y) / 2;
                            ctx.quadraticCurveTo(cpX, cpY, x, y);
                        }
                        
                        x += sliceWidth;
                    }
                    
                    ctx.stroke();
                    ctx.shadowBlur = 0;
                    
                    // Mirror efekt
                    ctx.beginPath();
                    ctx.strokeStyle = 'rgba(251, 191, 36, 0.1)';
                    ctx.lineWidth = 2;
                    
                    x = 0;
                    for (let i = 0; i < dataLength; i++) {
                        let v = 0;
                        if (this.timeData) {
                            v = (this.timeData[i] - 128) / 128;
                        } else {
                            v = Math.sin(this.phase + i * 0.1) * 0.3;
                        }
                        
                        const amplitude = v * height * 0.2;
                        const y = centerY - amplitude + 15;
                        
                        if (i === 0) {
                            ctx.moveTo(x, y);
                        } else {
                            ctx.lineTo(x, y);
                        }
                        
                        x += sliceWidth;
                    }
                    
                    ctx.stroke();
                    
                    // Centralna linija
                    let average = 128;
                    if (this.timeData) {
                        average = Array.from(this.timeData).reduce((a, b) => a + b, 0) / this.timeData.length;
                    }
                    const intensity = Math.abs(average - 128) / 128;
                    
                    ctx.beginPath();
                    ctx.strokeStyle = `rgba(251, 191, 36, ${0.3 + intensity * 0.4})`;
                    ctx.lineWidth = 2;
                    ctx.moveTo(0, centerY);
                    ctx.lineTo(width, centerY);
                    ctx.stroke();
                };
                
                draw();
            }

            stopVisualizer() {
                if (this.animationId) {
                    cancelAnimationFrame(this.animationId);
                    this.animationId = null;
                }
                
                if (this.canvasCtx) {
                    this.canvasCtx.clearRect(0, 0, 320, 120);
                }
                
                if (this.audioContext) {
                    this.audioContext.close().catch(() => {});
                    this.audioContext = null;
                }
                
                this.phase = 0;
            }

            showMicIndicator(text = 'Ich h√∂re zu...') {
                if (!this.micContainer) return;
                
                this.micContainer.querySelector('.mic-text').textContent = text;
                this.micContainer.classList.remove('mic-processing', 'mic-error');
                this.micContainer.classList.add('active');
            }

            showProcessing() {
                if (!this.micContainer) return;
                
                this.micContainer.classList.add('mic-processing');
                this.micContainer.querySelector('.mic-text').textContent = 'Verarbeite...';
            }

            showError() {
                if (!this.micContainer) return;
                
                this.micContainer.classList.add('mic-error');
                this.micContainer.querySelector('.mic-text').textContent = 'Fehler';
                setTimeout(() => this.hideMicIndicator(), 2000);
            }

            hideMicIndicator() {
                this.stopVisualizer();
                if (this.micContainer) {
                    this.micContainer.classList.remove('active', 'mic-processing', 'mic-error');
                    const interim = this.micContainer.querySelector('.interim-text');
                    if (interim) interim.textContent = '';
                }
            }

            playSystemSound(type) {
                const audio = new Audio(this.audioAssets.system[type]);
                audio.volume = 0.6;
                return audio.play().catch(e => {
                    console.log('Audio play failed:', e);
                    return Promise.resolve();
                });
            }

            speak(text, lang = this.lang) {
                return new Promise((resolve) => {
                    speechSynthesis.cancel();
                    
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = lang;
                    utterance.rate = 0.9;
                    utterance.pitch = 1.0;
                    
                    // Pronaƒëi najbolji glas
                    const voices = speechSynthesis.getVoices();
                    const preferredVoice = voices.find(v => 
                        (v.lang === lang && v.name.includes('Google')) || 
                        (v.lang === lang && v.name.includes('Premium')) ||
                        (v.lang === lang && v.name.includes('Hans')) ||
                        v.lang === lang
                    );
                    
                    if (preferredVoice) {
                        utterance.voice = preferredVoice;
                    }
                    
                    utterance.onend = () => resolve();
                    utterance.onerror = () => resolve();
                    
                    speechSynthesis.speak(utterance);
                });
            }

            async listen() {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                
                return new Promise((resolve, reject) => {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    
                    if (!SpeechRecognition) {
                        stream.getTracks().forEach(track => track.stop());
                        reject('Speech recognition not supported');
                        return;
                    }
                    
                    this.recognition = new SpeechRecognition();
                    this.recognition.lang = this.lang;
                    this.recognition.interimResults = true;
                    this.recognition.maxAlternatives = 1;
                    this.recognition.continuous = false;
                    
                    this.initAudioContext(stream);
                    
                    let finalTranscript = '';
                    
                    this.recognition.onresult = (event) => {
                        const results = event.results;
                        const last = results[results.length - 1];
                        
                        if (last.isFinal) {
                            finalTranscript = last[0].transcript;
                        } else {
                            const interim = last[0].transcript;
                            const interimEl = this.micContainer.querySelector('.interim-text');
                            if (interimEl) interimEl.textContent = `"${interim}"`;
                        }
                    };
                    
                    this.recognition.onerror = (event) => {
                        stream.getTracks().forEach(track => track.stop());
                        reject(event.error);
                    };
                    
                    this.recognition.onend = () => {
                        stream.getTracks().forEach(track => track.stop());
                        if (finalTranscript) {
                            resolve(finalTranscript);
                        } else {
                            reject('No speech detected');
                        }
                    };
                    
                    this.recognition.start();
                });
            }

            async start() {
                try {
                    this.isListening = true;
                    this.updateButtonState();
                    
                    await this.playSystemSound('micStart');
                    this.showMicIndicator('Ich h√∂re zu...');
                    
                    await new Promise(r => setTimeout(r, 500));
                    
                    const userText = await this.listen();
                    console.log("üëÇ Erkannt:", userText);
                    
                    this.showProcessing();
                    await this.playSystemSound('micStop');
                    
                    const response = await this.processCommand(userText);
                    this.lastResponse = response;
                    
                    this.showResponse(response);
                    await this.speak(response);
                    await this.playSystemSound('success');
                    
                } catch (error) {
                    console.error("‚ùå Fehler:", error);
                    this.showError();
                    await this.playSystemSound('error');
                    
                    const errorMsg = "Entschuldigung, ich habe Sie nicht verstanden. Bitte versuchen Sie es erneut.";
                    this.showResponse(errorMsg);
                    await this.speak(errorMsg);
                } finally {
                    this.isListening = false;
                    this.updateButtonState();
                    this.hideMicIndicator();
                }
            }

            showResponse(text) {
                if (this.responseText) {
                    this.responseText.textContent = text;
                }
                if (this.responsePanel) {
                    this.responsePanel.classList.add('active');
                }
                
                setTimeout(() => {
                    this.hideResponse();
                }, 8000);
            }

            hideResponse() {
                if (this.responsePanel) {
                    this.responsePanel.classList.remove('active');
                }
            }

            speakResponse() {
                if (this.lastResponse) {
                    this.speak(this.lastResponse);
                }
            }

            async processCommand(text) {
                const lowerText = text.toLowerCase();
                
                // 1. Pretra≈æivanje sobe
                const roomMatch = lowerText.match(/(\d{3})/) || lowerText.match(/zimmer\s+(\d{1,3})/i);
                if (roomMatch || lowerText.includes('zimmer')) {
                    const roomNumber = roomMatch ? roomMatch[1] : null;
                    
                    if (roomNumber) {
                        if (typeof window.activateVoiceNavigation === 'function') {
                            window.activateVoiceNavigation(roomNumber);
                        } else if (typeof activateVoiceNavigation === 'function') {
                            activateVoiceNavigation(roomNumber);
                        }
                        
                        return `Gerne begleite ich Sie zu Zimmer ${roomNumber}. Die Navigation wird angezeigt.`;
                    } else {
                        return "Welche Zimmernummer suchen Sie? Bitte nennen Sie die dreistellige Nummer.";
                    }
                }
                
                // 2. Restaurant i hrana
                if (lowerText.includes('restaurant') || lowerText.includes('essen') || lowerText.includes('fr√ºhst√ºck') || lowerText.includes('bar')) {
                    if (lowerText.includes('fr√ºhst√ºck') || lowerText.includes('breakfast')) {
                        if (typeof showSection === 'function') {
                            showSection('breakfast-guide');
                        }
                        return "Die Fr√ºhst√ºckszeiten sind von 6:30 bis 11:30 Uhr. Die aktuelle Auslastung sehen Sie in der Fr√ºhst√ºcks-Ampel.";
                    }
                    if (lowerText.includes('bar') || lowerText.includes('1910') || lowerText.includes('tausendeinhundertzehn')) {
                        if (typeof showSection === 'function') {
                            showSection('hotel-info');
                        }
                        return "Bar 1910 ist im Erdgeschoss. Ge√∂ffnet Dienstag bis Samstag von 18:00 bis 01:00 Uhr. Momentan Sommerpause bis 3. September.";
                    }
                    if (lowerText.includes('emil') || lowerText.includes('bistro') || lowerText.includes('caf√©')) {
                        if (typeof showSection === 'function') {
                            showSection('hotel-info');
                        }
                        return "Emil's Bistro ist in der Lobby, ge√∂ffnet t√§glich von 9:00 bis 24:00 Uhr.";
                    }
                    if (typeof showSection === 'function') {
                        showSection('hotel-info');
                    }
                    return "Unser Stadt-Restaurant befindet sich im Erdgeschoss, direkt von der Lobby erreichbar. M√∂chten Sie eine Reservierung?";
                }
                
                // 3. SPA i fitness
                if (lowerText.includes('spa') || lowerText.includes('sauna') || lowerText.includes('fitness') || lowerText.includes('gym') || lowerText.includes('wellness')) {
                    if (typeof showSection === 'function') {
                        showSection('hotel-info');
                    }
                    return "Das Fitnessstudio ist 24 Stunden ge√∂ffnet. Die Sauna ist t√§glich von 16:00 bis 22:00 Uhr ge√∂ffnet, 10 Euro Eintritt. Zugang √ºber den SPA-Aufzug.";
                }
                
                // 4. Notfall i sigurnost
                if (lowerText.includes('notfall') || lowerText.includes('hilfe') || lowerText.includes('krank') || lowerText.includes('arzt') || lowerText.includes('feuerwehr')) {
                    if (typeof showSection === 'function') {
                        showSection('emergency');
                    }
                    return "Im Notfall w√§hlen Sie bitte 112. Die Rezeption erreichen Sie unter Durchwahl 156. Haustechnik 770. Der Defibrillator befindet sich am Front Office.";
                }
                
                // 5. Lift i navigacija
                if (lowerText.includes('aufzug') || lowerText.includes('lift') || lowerText.includes('fahrstuhl') || lowerText.includes('treppe')) {
                    return "Der barrierefreie SPA-Aufzug ist 110 cm breit und f√ºhrt zu allen Etagen. Der historische TH-Aufzug ist nur 70 cm breit. Ab dem 2. Obergeschoss ben√∂tigen Sie die Zimmerkarte.";
                }
                
                // 6. WiFi i tehniƒçko
                if (lowerText.includes('wlan') || lowerText.includes('wifi') || lowerText.includes('internet') || lowerText.includes('passwort')) {
                    return "Das WLAN-Netzwerk ist 'Reichshof Hamburg'. Das Passwort erhalten Sie an der Rezeption oder auf Ihrer Zimmerkarte.";
                }
                
                // 7. Check-in/out
                if (lowerText.includes('check') || lowerText.includes('einchecken') || lowerText.includes('auschecken') || lowerText.includes('anreise') || lowerText.includes('abreise')) {
                    if (lowerText.includes('aus') || lowerText.includes('abreise')) {
                        return "Check-out ist bis 11:00 Uhr. Late Check-out ist auf Anfrage m√∂glich.";
                    }
                    return "Der Check-in ist ab 15:00 Uhr m√∂glich. Fr√ºher Check-in k√∂nnen wir je nach Verf√ºgbarkeit anbieten.";
                }
                
                // 8. Povijest hotela
                if (lowerText.includes('geschichte') || lowerText.includes('historie') || lowerText.includes('alt') || lowerText.includes('1910') || lowerText.includes('langer')) {
                    if (typeof showSection === 'function') {
                        showSection('history-poi');
                    }
                    return "Der Reichshof wurde 1910 erbaut. Die Gedenktafel f√ºr Anton Emil Langer finden Sie im Zwischengeschoss. Das Jubil√§umsbuch erhalten Sie am Front Office.";
                }
                
                // 9. Barrierefreiheit
                if (lowerText.includes('rollstuhl') || lowerText.includes('behinderung') || lowerText.includes('barrierefrei') || lowerText.includes('behindertengerecht')) {
                    if (typeof showSection === 'function') {
                        showSection('accessibility');
                    }
                    return "Wir haben barrierefreie Zimmer 212, 218, 318, 327 und 411. Der SPA-Aufzug ist vollst√§ndig barrierefrei. M√∂chten Sie mehr Details zu einem bestimmten Zimmer?";
                }
                
                // 10. Housekeeping
                if (lowerText.includes('reinigung') || lowerText.includes('handtuch') || lowerText.includes('service') || lowerText.includes('housekeeping') || lowerText.includes('bett')) {
                    if (typeof showSection === 'function') {
                        showSection('housekeeping');
                    }
                    return "Housekeeping-Service k√∂nnen Sie √ºber den Hausservice-Bereich anfordern. M√∂chten Sie frische Handt√ºcher oder Zimmerreinigung?";
                }
                
                // 11. QR kodovi i novine
                if (lowerText.includes('qr') || lowerText.includes('code') || lowerText.includes('zeitung') || lowerText.includes('newspaper') || lowerText.includes('magazin')) {
                    if (typeof showSection === 'function') {
                        showSection('qr-codes');
                    }
                    return "QR-Codes f√ºr Zeitungen und Zimmer-Navigation finden Sie im QR-Codes Bereich. Kostenlose Zeitungen sind √ºber sharemagazines.de verf√ºgbar.";
                }
                
                // 12. Recepcija i osoblje
                if (lowerText.includes('rezeption') || lowerText.includes('empfang') || lowerText.includes('concierge') || lowerText.includes('personal')) {
                    return "Die Rezeption ist 24 Stunden besetzt. Der Concierge befindet sich meist ganz rechts am Tresen. F√ºr alle Insiderfragen steht Ihnen unser Team gerne zur Verf√ºgung.";
                }
                
                // 13. Parkiranje
                if (lowerText.includes('parken') || lowerText.includes('parkplatz') || lowerText.includes('auto') || lowerText.includes('garage') || lowerText.includes('silo')) {
                    return "Das historische Autosilo ist verf√ºgbar. Besichtigung als gef√ºhrte Story-Station m√∂glich. Bitte erfragen Sie am Front Office oder bei Sales.";
                }
                
                // 14. Gep√§ck
                if (lowerText.includes('gep√§ck') || lowerText.includes('koffer') || lowerText.includes('tasche') || lowerText.includes('luggage')) {
                    return "Der Gep√§ckraum ist nur f√ºr autorisiertes Personal und video√ºberwacht. Ausgabe nur gegen Original-Ticket oder Koffernummer. Tipp: Machen Sie ein Foto von Koffer plus Ticket.";
                }
                
                // 15. Markt/Marketplace
                if (lowerText.includes('markt') || lowerText.includes('marketplace') || lowerText.includes('k√ºhlschrank') || lowerText.includes('snack') || lowerText.includes('getr√§nk')) {
                    return "Der 24-Stunden Marketplace befindet sich in der Lobby gegen√ºber dem Front Office. Er bietet Getr√§nke, Snacks und Reise-Utensilien.";
                }
                
                // Default odgovor
                return "Ich habe Sie leider nicht genau verstanden. Ich kann Ihnen helfen mit: Zimmerfindung, Restaurant-Infos, SPA-√ñffnungszeiten, Notfallnummern, Barrierefreiheit, oder Housekeeping. Was ben√∂tigen Sie?";
            }
        }

        // ============================================
        // GLOBALNA INICIJALIZACIJA
        // ============================================

        let reichshofAssistant;

        // Inicijalizacija kada je DOM spreman
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initVoiceAssistant);
        } else {
            initVoiceAssistant();
        }

        function initVoiceAssistant() {
            // Priƒçekaj da se ostali skriptovi uƒçitaju
            setTimeout(() => {
                reichshofAssistant = new ReichshofVoiceAssistant();
                
                // Pove≈æi s postojeƒáim voice-navigation.js
                if (typeof window.voiceNavigation !== 'undefined') {
                    console.log('‚úÖ Integrated with existing voice-navigation.js');
                }
                
                // Override postojeƒáe funkcije za kompatibilnost
                window.toggleVoiceAssistant = function() {
                    if (reichshofAssistant) {
                        reichshofAssistant.toggle();
                    }
                };
                
                console.log('üéôÔ∏è Reichshof Voice Assistant ready');
            }, 100);
        }

        // Fallback za starije browsere
        window.speakVoiceMessage = function(text) {
            if (reichshofAssistant) {
                reichshofAssistant.speak(text);
            } else {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'de-DE';
                speechSynthesis.speak(utterance);
            }
        };

        // Integracija s postojeƒáim activateVoiceNavigation
        const originalActivateVoiceNavigation = window.activateVoiceNavigation;
        
        window.activateVoiceNavigation = function(roomNumber) {
            // Pozovi originalnu funkciju ako postoji
            if (typeof originalActivateVoiceNavigation === 'function') {
                originalActivateVoiceNavigation(roomNumber);
            }
            
            // Dodaj vizualnu notifikaciju
            const notification = document.getElementById('notification');
            if (notification) {
                notification.innerHTML = `
                    <div style="background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); color: white; padding: 20px; border-radius: 15px; border: 2px solid #fbbf24; box-shadow: 0 10px 40px rgba(0,0,0,0.4);">
                        <h3 style="margin-top:0; color: #fbbf24;"><i class="fas fa-route"></i> Navigation zu Zimmer ${roomNumber}</h3>
                        <p style="font-size: 16px; line-height: 1.6;">Die Wegbeschreibung wird angezeigt...</p>
                    </div>
                `;
                notification.style.display = 'block';
                setTimeout(() => notification.style.display = 'none', 5000);
            }
        };
    </script>
</body>
</html>
